{% extends 'base.html' %}
    {% block content %}
        <ol class="breadcrumb">
          <li><a href="{% url 'block_list' %}">首页</a></li>
          <li><a href={% url 'article_list' article.block.id %}>{{ article.block }}</a></li>
          <li class="active">{{ article.title }}</li>
        </ol>
        <div class="panel panel-default">
          <div class="panel-body">
              <p>作者：{{ article.owner }}</p>
              <p>标题：{{ article.title }}</p>
              <p>内容：{{ article.content }}</p>
              <p>创建时间：{{ article.create_timestamp|date:"Y-m-d P"}}</p>
          </div>
        </div>
{#评论展示及分页#}
        {% for comment in comments %}
            <div class="panel panel-default">
              <div class="panel-body">
                <p>作者:{{ comment.owner }}</p>
                <p>评论内容：{{ comment.content | linebreaksbr }}</p>
                {% include "component/paginator.html" with param_name="comment_page_no" %}
              </div>
            </div>
          {% endfor %}
            {% if user.is_authenticated %}
            <div class="input-group input-group-sm">
              <span class="input-group-addon">作者:{{ user }}</span>
              <input type="text" id="commentContent" class="form-control" placeholder="" aria-describedby="sizing-addon1">
            </div>
            <form method="post" action="">
                <button type="submit" id="commentBtn" class="btn btn-primary btn-sm active">发表</button>
            </form>
            {% endif %}
        <script type="text/javascript">
            $(document).ready(function () {
              $("#commentBtn").click(function () {
                var article_id = {{ article.id }};
                var to_comment_id = 0;
                var comment = $("#commentContent").val();
                var page_cnt = {{ page_cnt }};
                var param = {"article_id": article_id, "to_comment_id": to_comment_id, "content": comment};
                $.post("{% url 'create_comment' %}", param, function () {
                  $("#commentContent").val("");
                  window.location.href = "{% url 'ariticle_detail' article.id %}?comment_page_no=" + (page_cnt + 1);
                });
              })
            });
        </script>
    {% endblock %}